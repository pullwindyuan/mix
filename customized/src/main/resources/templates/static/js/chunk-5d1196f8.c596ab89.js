(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d1196f8"],{5713:function(t,e,i){"use strict";i("d03a")},"7fc7":function(t,e,i){},a37e:function(t,e,i){},d03a:function(t,e,i){},f36c:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"benchmarking-company",class:[t.size,t.theme],on:{click:t.show}},[i("div",{staticClass:"benchmarking-label",style:t.labelStyle},[t._v("对标公司")]),i("div",{staticClass:"benchmarking-value"},[i("div",{staticClass:"benchmarking-company-text"},[t._v(" "+t._s(t.dataText)+" ")]),t._m(0)])]),i("SelectCompany",{ref:"modal",attrs:{onlyIndustry:t.onlyIndustry,companyInfo:t.companyInfo,hideFirst:t.hideFirst},on:{submitTap:t.submitTap}})],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"benchmarking-company-icon"},[i("i",{staticClass:"el-icon-arrow-down"})])}],n=(i("a15b"),i("d81d"),i("a9e3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"el-fade-in-linear"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],staticClass:"select-company-box",on:{click:t.hide}},[i("div",{staticClass:"select-company-content",on:{click:function(t){t.stopPropagation()}}},[i("div",{staticClass:"select-title"},[i("div",{staticClass:"select-title-text"},[t._v("选择对标公司")]),i("div",{staticClass:"select-title-icon",on:{click:t.hide}},[i("i",{staticClass:"el-icon-close"})])]),i("div",{staticClass:"select-main"},[i("div",{staticClass:"input-box"},[i("el-input",{attrs:{placeholder:"请输入上市公司股票名称 / 代码 / 简拼",size:"normal",clearable:""},on:{input:t.input},model:{value:t.queryData.keyword,callback:function(e){t.$set(t.queryData,"keyword",e)},expression:"queryData.keyword"}})],1),i("div",{staticClass:"tag-box"},t._l(t.tagList,(function(e){return i("el-tag",{key:e.id,staticClass:"tag",attrs:{"disable-transitions":"",size:"medium",closable:""},on:{close:function(i){return t.companyTap(e)}}},[t._v(t._s(e.companyName))])})),1),i("div",{staticClass:"func-wrap"},[i("div",{staticClass:"tab-list"},t._l(t.filterTabList,(function(e){return i("el-button",{key:e.id,attrs:{type:t.activeIndex===e.id?"primary":"default",size:"mini"},on:{click:function(i){return t.tabTap(e)}}},[t._v(t._s(e.title))])})),1),i("div",{staticClass:"sort-list"},[i("label",{staticClass:"label-t",attrs:{for:""}},[t._v("排序")]),i("el-select",{staticClass:"sort1",attrs:{size:"mini",placeholder:"请选择"},on:{change:t.handleChangeDesc},model:{value:t.sortListVal,callback:function(e){t.sortListVal=e},expression:"sortListVal"}},t._l(t.sortListArr,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("el-select",{staticClass:"sort2",attrs:{size:"mini",placeholder:"请选择"},on:{change:t.handleChangeDesc},model:{value:t.descListVal,callback:function(e){t.descListVal=e},expression:"descListVal"}},t._l(t.descListArr,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"result-box g-map-loading",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)","element-loading-spinner":"el-icon-loading"}},[i("VirtualList",{ref:"virt",staticClass:"item-box",attrs:{"data-key":"id","data-sources":t.companyList,"data-component":t.ItemComponent,"extra-props":{onItemClick:t.companyTap,disabled:t.disabled},"estimate-size":50,keeps:20},on:{tobottom:t.tobottom}}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.companyList.length,expression:"!companyList.length"}],staticClass:"result-no-data"},[t._v(" 暂无数据 ")])],1),i("div",{staticClass:"select-main-footer"},[i("div",{staticClass:"footer-text-box"},[i("el-button",{attrs:{size:"small"}},[i("span",[t._v(t._s(t.selectedList.length)+" / "+t._s(t.limit))])])],1),i("div",{staticClass:"submit"},[i("el-button",{attrs:{type:"primary",disabled:!t.selectedList.length,size:"small"},on:{click:t.submitTap}},[t._v("提交")])],1)])])])])])}),o=[],r=(i("99af"),i("4de4"),i("7db0"),i("c740"),i("4160"),i("fb6a"),i("a434"),i("ac1f"),i("1276"),i("159b"),i("96cf"),i("1da1")),c=i("5530"),l=i("f4dd"),d=i("bc3a"),u=i("f348"),h={methods:{mixinSetBodyOverFlow:function(t){document.body.style.overflow=t?"hidden":""}}},m=i("89c1"),p=i.n(m),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"company-item",class:[t.source.selected?"active":""],on:{click:t.itemTap}},[i("div",{staticClass:"company-item-text"},[t._v(" "+t._s(t.source.companyName)+" ")]),i("div",{staticClass:"company-item-code"},[t._v("（"+t._s(t.getCode())+"）")]),i("div",{staticClass:"company-item-checkbox"},[i("i",{directives:[{name:"show",rawName:"v-show",value:t.source.selected,expression:"source.selected"}],staticClass:"el-icon-check"})])])},y=[],v={props:{index:{type:Number},source:{type:Object,default:function(){return{}}},onItemClick:{type:Function}},data:function(){return{}},methods:{itemTap:function(){this.onItemClick&&this.onItemClick(this.source)},getCode:function(){return this.source.code.split(".")[0]}}},b=v,L=(i("f6b1"),i("2877")),g=Object(L["a"])(b,f,y,!1,null,"170bea21",null),C=g.exports,_=i("2f62"),w=i("c598"),O={name:"abc",mixins:[h],props:{limit:{type:Number,default:3},companyInfo:{type:Object,default:function(){return{}}},onlyIndustry:{type:Boolean,default:!1},hideFirst:{type:Boolean,default:!1}},components:{ItemComponent:C,VirtualList:p.a},data:function(){return{sortListVal:"RISK_SCORE_LEVEL",sortListArr:[{label:"企业风险概率",value:"RISK_SCORE_LEVEL"},{label:"企业价值评估",value:"WORTH_SCORE_LEVEL"},{label:"企业竞争能力",value:"COMPETITIVE_SCORE_LEVEL"},{label:"企业发展能力",value:"DEVELOP_SCORE_LEVEL"},{label:"企业生存能力",value:"SURVIVE_SCORE_LEVEL"},{label:"企业经营效率",value:"OPERATE_EFFICE_SCORE_LEVEL"},{label:"企业营业收入",value:"tr"},{label:"企业营业利润",value:"net"},{label:"企业市值",value:"market_value"}],descListVal:1,descListArr:[{label:"从高到低",value:0},{label:"从低到高",value:1}],ItemComponent:C,queryData:{current:1,size:100,keyword:"",location:"",industryCode:""},loading:!1,showFlag:!1,tabList:[],activeIndex:"owner",companyList:[],totalPage:0,selectedList:[]}},computed:Object(c["a"])({selectedData:function(){var t=Object(u["a"])(this.selectedList,"id");return t},disabled:function(){return this.selectedList.length>=this.limit},tagList:function(){return this.selectedList.slice().reverse()},filterTabList:function(){return this.onlyIndustry?[this.tabList[0]]:this.tabList}},Object(_["c"])(["mindInfo"])),created:function(){this._initUIView()},methods:{handleChangeDesc:function(){this.queryTap()},hide:function(){w["a"].$emit("companyModalHide"),this.showFlag=!1,this.mixinSetBodyOverFlow(!1),this.selectedList=JSON.parse(JSON.stringify(this._cashSelectList)),this.setActiveList()},show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w["a"].$emit("companyModalShow"),this.showFlag=!0,this.mixinSetBodyOverFlow(!0),this.selectedList=t.selectedList?JSON.parse(JSON.stringify(t.selectedList)):[],this._cashSelectList=JSON.parse(JSON.stringify(this.selectedList)),this.setActiveList()},setActiveList:function(){var t=Object(u["a"])(this.selectedList,"id");this.companyList.forEach((function(e){t[e.id]?e.selected=!0:e.selected=!1}))},tabTap:function(t){if(t.id!==this.activeIndex){if(this.activeIndex=t.id,"owner"===t.id){var e=this.companyInfo.industryCode?this.companyInfo.industryCode:this.mindInfo.industryCode;this.queryData.industryCode=e}else this.queryData.industryCode="",this.queryData.location=t.id;this.queryTap()}},input:function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.queryTap()}),500)},tobottom:function(){this.loading||this._prevParams.current>=this.totalPage||this._apiGetCompanyDialog(Object(c["a"])(Object(c["a"])({},this._prevParams),{},{current:this._prevParams.current+1,index:this.sortListVal,asc:this.descListVal}))},resetVirt:function(){var t=this.$refs.virt;t&&t.reset()},companyTap:function(t){var e=this;if(t.noFourSeason)return this.$message({type:"warning",message:"当前公司季报数据不满4个季度，暂不支持相关分析，请期待更新！"});var i=this.companyList.findIndex((function(e){return t.id===e.id})),s=this.companyList[i],a=this.selectedData[t.id];if(a)return this.selectedList.splice(a.__index,1),void(s&&(s.selected=!1));if(this.disabled){var n=this.companyList.find((function(t){return t.id===e.selectedList[0].id}));n&&(n.selected=!1),this.selectedList.shift(0)}this.selectedList.push(t),s&&(s.selected=!0)},submitTap:function(t){var e=JSON.parse(JSON.stringify(this.selectedList));this.$emit("submitTap",e),this.showFlag=!1,this.mixinSetBodyOverFlow(!1),t&&(this.addHistorySearch(e),w["a"].$emit("companyModalHide"))},addHistorySearch:function(t){var e=t.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{companyId:t.id,type:1})}));this._apiAddCompanyHistoryBatch(e)},queryTap:function(){this.resetVirt();var t=this.$formatAxiosReq(Object(c["a"])(Object(c["a"])({},this.queryData),{},{current:1,index:this.sortListVal,asc:this.descListVal}));this._apiGetCompanyDialog(t)},initData:function(){var t=this.companyInfo.industryCode;t=t||this.mindInfo.industryCode;var e={current:1,size:100,keyword:"",location:"",industryCode:t,index:this.sortListVal,asc:this.descListVal};this.queryData=e,this._prevParams=JSON.parse(JSON.stringify(this.queryData))},formatResdata:function(t){var e=this;return t.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{noFourSeason:!e.computedSeason(t),selected:!!e.selectedData[t.id]})}))},hanldeResult:function(t){var e=this;if(this.loading=!1,!this._inited&&!this.hideFirst){this._inited=!0;var i=t.history.filter((function(t){return e.mindInfo.companyId!==t.id}));i=this.onlyIndustry?i.filter((function(t){return t.industryCode===e.mindInfo.industryCode})):i;var s=i.slice(0,3);this.selectedList=s.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{id:t.companyId})})),this.submitTap()}var a=this.formatResdata(t.list.records);this.totalPage=t.pages,this.companyList=1===t.current?a:this.companyList.concat(a);var n=this.companyList.filter((function(t){return t.id!==e.mindInfo.companyId}));this.companyList=n},hanldeResult1:function(t){var e=this;this.loading=!1;var i=this.formatResdata(t.list.records);this.totalPage=t.pages,this.companyList=1===t.current?i:this.companyList.concat(i);var s=this.companyList.filter((function(t){return t.id!==e.mindInfo.companyId}));if(!this._inited&&!this.hideFirst){this._inited=!0;var a=i.filter((function(t){return!t.noFourSeason})),n=Math.min(this.limit,a.length);n=n===a.length?n-1:n;var o=[],r=0;while(o.length<n){var c=a[r];this.mindInfo.companyId!==c.id&&(c.selected=!0,o.push(c)),r++}this.selectedList=o,this.submitTap()}this.companyList=s},computedSeason:function(t){if(!t.startSeason||!t.endSeason)return!1;var e=t.startSeason.split("_"),i=t.endSeason.split("_"),s=e[1],a=4*+(i[0]-e[0])+ +i[1];return a-s>=3},_initUIView:function(){this.initData(),this._initTabList(),this.queryTap()},_initTabList:function(){this.tabList=[{title:"本行业",id:"owner"},{title:"全部",id:""}]},_apiGetCompanyDialog:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,e.loading=!0,e.source||(e.source={}),e.source.c&&e.source.c("请求终止"),i.next=6,Object(l["g"])(t);case 6:s=i.sent,e._prevParams=JSON.parse(JSON.stringify(t)),e.hanldeResult(s),i.next=16;break;case 11:if(i.prev=11,i.t0=i["catch"](0),!(i.t0 instanceof d["Cancel"])){i.next=15;break}return i.abrupt("return");case 15:e.loading=!1;case 16:case"end":return i.stop()}}),i,null,[[0,11]])})))()},_apiAddCompanyHistoryBatch:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l["a"])(t);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e["catch"](0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))()}},beforeDestroy:function(){this.timer&&clearTimeout(this.timer)}},I=O,x=(i("5713"),Object(L["a"])(I,n,o,!1,null,"6f8f06f7",null)),S=x.exports,k={props:{companyInfo:{type:Object,default:function(){return{}}},labelRight:{type:Number,default:35},multiple:{type:Boolean,default:!1},limit:{type:Number,default:5},size:{type:String,default:"default"},theme:{type:String,default:"dark"},onlyIndustry:{type:Boolean,default:!1},hideFirst:{type:Boolean,default:!1}},components:{SelectCompany:S},data:function(){return{dataList:[],value:""}},computed:{labelStyle:function(){return{marginRight:this.labelRight+"px"}},dataText:function(){return this.dataList.map((function(t){return t.companyName})).join("/")}},created:function(){this._initUIView()},methods:{show:function(){this.$refs.modal.show({selectedList:this.dataList})},submitTap:function(t){this.dataList=t,this.$emit("change",t)},change:function(t){this.dataList=t},_initUIView:function(){}}},E=k,T=(i("f46c"),Object(L["a"])(E,s,a,!1,null,"0d9288d0",null));e["a"]=T.exports},f46c:function(t,e,i){"use strict";i("a37e")},f6b1:function(t,e,i){"use strict";i("7fc7")}}]);