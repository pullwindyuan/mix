(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-359b24bc"],{"0538":function(e,t,n){"use strict";var r=n("1c0b"),a=n("861d"),i=[].slice,o={},c=function(e,t,n){if(!(t in o)){for(var r=[],a=0;a<t;a++)r[a]="a["+a+"]";o[t]=Function("C,a","return new C("+r.join(",")+")")}return o[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=i.call(arguments,1),o=function(){var r=n.concat(i.call(arguments));return this instanceof o?c(t,r.length,r):t.apply(e,r)};return a(t.prototype)&&(o.prototype=t.prototype),o}},"081a":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return s}));n("99af"),n("4160"),n("b64b"),n("159b");function r(e){var t=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;return t.test(e)}function a(e){var t=[/[\w\W]{8,16}/,/\d+/,/[a-z]+/,/[A-Z]+/],n=!0;return t.forEach((function(t){if(!t.test(e))return n=!1})),n}function i(e){return e=e||"手机号码格式不正确",function(t,n,a){r(n)?a():a(new Error(e))}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"数据",n=arguments.length>2?arguments[2]:void 0,r="";return function(a,i,o){var c=e.min,s=e.max;n?r=n:(c=c||1,c&&s?r=c===s?"".concat(t,"长度应该为 ").concat(c," 个字符"):"".concat(t,"长度应在 ").concat(c," - ").concat(s," 之间"):c&&(r="".concat(t,"长度最少为 ").concat(c," 个字符"))),i.length<c||s&&i.length>s?o(new Error(r)):o()}}function c(e){return e=e||"密码8～16位必须包含大小写字母和数字",function(t,n,r){var i=a(n);i?r():r(new Error(e))}}function s(e,t,n){return n=n||"两次输入密码不一致!",function(r,a,i){var o=e[t];""===a?i(new Error("请再次输入密码")):a===o?i():i(new Error(n))}}},"11ba":function(e,t,n){"use strict";n("8198")},2264:function(e,t,n){"use strict";n("b505")},"257e":function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},"262e":function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,"a",(function(){return a}))},"2caf":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("4ae1"),n("3410");function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n("d3b7"),n("25f0");function a(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var i=n("53ca"),o=n("257e");function c(e,t){return!t||"object"!==Object(i["a"])(t)&&"function"!==typeof t?Object(o["a"])(e):t}function s(e){var t=a();return function(){var n,a=r(e);if(t){var i=r(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return c(this,n)}}},"329b":function(e,t,n){"use strict";n("d3b7"),n("96cf");var r=n("1da1");t["a"]={methods:{mixinResetFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[e]&&this.$refs[e].resetFields()},mixinValidate:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"form",n.abrupt("return",new Promise((function(e){t.$refs[r].validate((function(t){if(!t)return e(!1),!1;e(!0)}))})));case 2:case"end":return n.stop()}}),n)})))()}}}},3410:function(e,t,n){var r=n("23e7"),a=n("d039"),i=n("7b0b"),o=n("e163"),c=n("e177"),s=a((function(){o(1)}));r({target:"Object",stat:!0,forced:s,sham:!c},{getPrototypeOf:function(e){return o(i(e))}})},"46fa":function(e,t,n){"use strict";n("50c0")},"4ae1":function(e,t,n){var r=n("23e7"),a=n("d066"),i=n("1c0b"),o=n("825a"),c=n("861d"),s=n("7c73"),u=n("0538"),l=n("d039"),f=a("Reflect","construct"),d=l((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),p=!l((function(){f((function(){}))})),h=d||p;r({target:"Reflect",stat:!0,forced:h,sham:h},{construct:function(e,t){i(e),o(t);var n=arguments.length<3?e:i(arguments[2]);if(p&&!d)return f(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var a=n.prototype,l=s(c(a)?a:Object.prototype),h=Function.apply.call(e,l,t);return c(h)?h:l}})},"50c0":function(e,t,n){},8198:function(e,t,n){},9383:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));n("96cf");var r=n("1da1"),a=n("d4ec"),i=n("bee2"),o=n("262e"),c=n("2caf"),s=n("c824"),u=n("f348"),l=function(e){Object(o["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),t.call(this)}return Object(i["a"])(n,[{key:"getOptions",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.params,r=t.api,a=t.valueKey,i=t.labelKey,o=t.others,e.prev=1,e.next=4,r(n);case 4:return c=e.sent,this.handleResdata&&(c=this.handleResdata(c)),s=Object(u["b"])(c,a,i,o),l=Object(u["a"])(c,a),e.abrupt("return",{options:s,optionsData:l});case 11:return e.prev=11,e.t0=e["catch"](1),e.abrupt("return",{options:[],optionsData:{}});case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"beforeUpdate",value:function(){this.__cacheData&&0!==this.__cacheData.options.length||this.update()}}]),n}(s["default"])},b069:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"role-page"},[n("div",{staticClass:"role-content"},[n("div",{staticClass:"role-content-left"},[n("RoleMenu",{on:{roleTap:e.roleTap}})],1),n("div",{staticClass:"role-content-right"},[n("RoleTable",{ref:"power"})],1)])])},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"left-menu"},[n("div",{staticClass:"role-menu"},[n("div",{staticClass:"role-menu-header"},[n("span",{staticClass:"t"},[e._v("用户角色列表")]),n("i",{staticClass:"icon el-icon-circle-plus-outline",on:{click:e.addTap}})]),n("div",{staticClass:"role-menu-list nice-scroll2"},e._l(e.data,(function(t){return n("div",{key:t.id,staticClass:"role-menu-item",class:[t.id===e.active.id?"active":""],on:{click:function(n){return e.menuTap(t)}}},[n("div",{staticClass:"name"},[e._v(e._s(t.roleName))]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.id===e.active.id&&1!==t.id,expression:"item.id === active.id && item.id !== 1"}],staticClass:"icon-box"},[n("i",{staticClass:"icon iconfont icon-bianji g-font-14",on:{click:function(n){return n.stopPropagation(),e.editTap(t)}}}),n("i",{staticClass:"icon iconfont icon-shanchu g-font-14",on:{click:function(n){return n.stopPropagation(),e.deleteTap(t)}}})])])})),0)]),n("AddEditRole",{ref:"modal",on:{submitSuccess:e.queryTap}}),n("DeleteRole",{ref:"delete",on:{submitSuccess:e.queryTap}})],1)},o=[],c=(n("96cf"),n("1da1")),s=n("bc3a"),u=n.n(s);function l(e){var t="/role";return u.a.get(t,{query:e})}function f(e){var t="/role";return u.a.post(t,e)}function d(e){var t="/role/".concat(e.roleId);return u.a.delete(t)}function p(e){var t="/role";return u.a.put(t,e)}function h(e){var t="/role/function/"+e;return u.a.get(t,{query:{}})}function v(e){var t="/role/function";return u.a.post(t,e)}var m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g-modal",{ref:"modal",attrs:{width:"496px",title:e.title},on:{closed:e.closed}},[n("div",[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"left",inline:!1,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{prop:"roleName",label:"角色名称"}},[n("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName","string"===typeof t?t.trim():t)},expression:"form.roleName"}})],1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{loading:e.submitLoading,size:"small",type:"primary"},on:{click:e.submitTap}},[e._v("保存")])],1)])},b=[],g=n("329b"),w=n("081a"),R={mixins:[g["a"]],data:function(){return{title:"",form:{roleName:"",detail:""},rules:{},submitLoading:!1}},created:function(){this._initUIView()},methods:{hide:function(){this.$refs.modal.hide()},show:function(e){var t=e.title,n=e.data;this.mixinResetFields(),this.title=t||"添加角色",this.initData(n),this.$refs.modal.show()},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.form.roleName=e.roleName||"",this.form.id=e.id||null},closed:function(){this.submitLoading=!1},submitTap:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.mixinValidate();case 2:n=t.sent,n&&(e.form.id?e._apiEditRole(e.form):e._apiAddRole(e.form));case 4:case"end":return t.stop()}}),t)})))()},_initUIView:function(){this._initRules()},_initRules:function(){this.rules={roleName:[{required:!0,validator:Object(w["c"])({min:2},"角色名称"),trigger:"blur"}]}},_apiAddRole:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.submitLoading=!0,n={roleName:t.form.roleName},e.next=5,f(n);case 5:e.sent,t.hide(),t.$emit("submitSuccess"),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})))()},_apiEditRole:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.submitLoading=!0,n.next=4,p(e);case 4:t.hide(),t.$emit("submitSuccess"),n.next=10;break;case 8:n.prev=8,n.t0=n["catch"](0);case 10:case"end":return n.stop()}}),n,null,[[0,8]])})))()}}},_=R,y=n("2877"),x=Object(y["a"])(_,m,b,!1,null,"58afa7aa",null),O=x.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g-modal",{ref:"modal",attrs:{width:"496px",title:"温馨提示",iconColor:"#FF9931",icon:"el-icon-warning"},on:{closed:e.closed}},[n("div",{staticClass:"g-pos-center"},[n("span",[e._v("请确认是否删除")]),n("span",{staticClass:"g-span-info"},[e._v(" "+e._s(e.roleName)+" ")]),n("span",[e._v("角色？")])]),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{loading:e.submitLoading,size:"small",type:"primary"},on:{click:e.submitTap}},[e._v("确认")])],1)])},k=[],T=(n("b0c0"),{data:function(){return{roleName:"管理员",submitLoading:!1,roleId:""}},methods:{hide:function(){this.$refs.modal.hide()},show:function(e){var t=e.data;this.roleName=t.name,this.roleId=t.id,this.$refs.modal.show()},submitTap:function(){this._apiDeleteRole(this.roleId)},closed:function(){this.submitLoading=!1},_apiDeleteRole:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.submitLoading=!0,n.next=4,d({roleId:e});case 4:t.$emit("submitSuccess"),t.hide(),n.next=10;break;case 8:n.prev=8,n.t0=n["catch"](0);case 10:t.submitLoading=!1;case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()}}}),C=T,$=Object(y["a"])(C,j,k,!1,null,"ade47e34",null),D=$.exports,I=n("fcad"),N={components:{AddEditRole:O,DeleteRole:D},data:function(){return{active:{},data:[]}},created:function(){this._initUIView()},methods:{addTap:function(){var e=this.$refs.modal;e&&e.show({})},editTap:function(e){var t=this.$refs.modal;t&&t.show({title:"编辑角色",data:e})},menuTap:function(e){this.active=e,this.$emit("roleTap",e)},deleteTap:function(e){var t=this.$refs.delete;t&&t.show({data:e})},checkedDefaultRole:function(e){this.menuTap(e)},_initUIView:function(){this.queryTap()},queryTap:function(){I["default"].update(),this._apiGetRoleList()},_apiGetRoleList:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l();case 3:n=t.sent,e.data=n,e.data&&e.data.length>0&&e.checkedDefaultRole(e.data[0]),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}},E=N,L=(n("11ba"),Object(y["a"])(E,i,o,!1,null,"731d1d5e",null)),F=L.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"g-loading",rawName:"v-g-loading",value:e.loading,expression:"loading"}],staticClass:"c-right"},[n("div",{staticClass:"role-table"},[n("div",{staticClass:"role-table-header"},[n("span",{staticClass:"t"},[e._v("功能权限配置")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:1!==e.curRoleId,expression:"curRoleId !== 1"}],staticClass:"btn",attrs:{size:"mini",loading:e.saveLoading,type:"primary"},on:{click:e.saveTap}},[e._v(" 保存 ")])],1),n("div",{staticClass:"role-table-list"},[n("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:e.tableData,border:"","header-row-class-name":e.getHeaderRowClassName}},[n("el-table-column",{attrs:{prop:"name",label:"一级菜单",width:"120",align:"center"}}),n("el-table-column",{attrs:{label:"二级菜单操作权限",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"checked-container"},e._l(t.row.children,(function(t){return n("el-checkbox",{key:t.id,attrs:{disabled:1===e.curRoleId,"true-label":1,"false-label":0},model:{value:t.select,callback:function(n){e.$set(t,"select",n)},expression:"item.select"}},[e._v(e._s(t.name))])})),1)]}}])})],1)],1)])])},P=[],q=(n("4160"),n("159b"),n("5530")),z=n("2f62"),V=n("ae6f"),A={data:function(){return{active:{},tableData:[],loading:!0,saveLoading:!1,curRoleId:1}},computed:Object(q["a"])({tableHeight:function(){return window.innerHeight-227}},Object(z["c"])(["userInfo"])),methods:{saveTap:function(){if(!this.saveLoading){var e=[];this.tableData.forEach((function(t){t.children&&t.children.forEach((function(t){1===t.select&&e.push(t.id)}))}));var t={roleId:this.curRoleId,functionIds:e};this._apiSaveRoleFunction(t)}},getHeaderRowClassName:function(){return"g-table-header"},queryTap:function(e){this.curRoleId=e.id,this._apiGetRoleFunction(e.id)},refresh:function(e){var t=this.userInfo.roles[0].id;+t===+e.roleId&&V["default"].refreshPage()},_apiGetRoleFunction:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.loading=!0,n.next=4,h(e);case 4:r=n.sent,t.tableData=r,n.next=10;break;case 8:n.prev=8,n.t0=n["catch"](0);case 10:t.loading=!1;case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},_apiSaveRoleFunction:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.saveLoading=!0,n.next=4,v(e);case 4:t.saveLoading=!1,t.$message({type:"success",message:"保存成功"}),t.refresh(e),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),t.saveLoading=!1;case 12:case"end":return n.stop()}}),n,null,[[0,9]])})))()}}},U=A,G=(n("2264"),Object(y["a"])(U,S,P,!1,null,"25be27f0",null)),H=G.exports,K={components:{RoleMenu:F,RoleTable:H},data:function(){return{activeRole:{},powerList:[]}},methods:{roleTap:function(e){this.activeRole=e;var t=this.$refs.power;t&&t.queryTap(e)},saveTap:function(){if(this.activeRole.id){var e=this.$refs.power;e&&e.getSaveData()}},addTap:function(){}}},J=K,M=(n("46fa"),Object(y["a"])(J,r,a,!1,null,"53ef6840",null));t["default"]=M.exports},b505:function(e,t,n){},fcad:function(e,t,n){"use strict";n.r(t);n("96cf");var r=n("1da1"),a=n("d4ec"),i=n("bee2"),o=n("262e"),c=n("2caf"),s=n("9383"),u=n("c24f"),l=function(e){Object(o["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),t.call(this)}return Object(i["a"])(n,[{key:"getValues",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getOptions({api:u["f"],valueKey:"id",labelKey:"roleName",others:["roleDesc"]});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(s["default"]);t["default"]=new l}}]);